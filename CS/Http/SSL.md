
## SSL, TLSλ€?
> μ©μ–΄μ μ •λ¦¬.
- SSL: Secure Sockets Layer
- TLS: Transport Layer Security

λ‘ μ©μ–΄μ λ” μμ„Έν• μ •μμ™€ ν•¨κ» μ–΄λ–¤ μ°¨μ΄κ°€ μλ”μ§€ ν™•μΈν•΄λ³΄μ.

## SSL
**SSL**μ€ μΈν„°λ„·μ μ΄κΈ° μ‹κΈ°μ—μ„ μ›Ή λ³΄μ•μ„ κ°•ν™”ν•κΈ° μ„ν• ν•„μ”μ„±μ—μ„ λΉ„λ΅―λμ—λ‹¤. μ΄μ°½κΈ° HTTPλ” λ°μ΄ν„°λ¥Ό ν‰λ¬ΈμΌλ΅ μ „μ†΅ν–λ”λ°, μ¤‘κ°„μ— κ°€λ΅μ±„λ” λ“±μ κ³µκ²©μ— μ·¨μ•½ν–λ‹¤. νΉν μ „μ μƒκ±°λμ™€ κ°™μ΄ λ―Όκ°ν• μ •λ³΄κ°€ μ¤κ°€λ” κ²½μ° μ΄λ¬ν• λ„μ²­μ΄ λ§¤μ° μ„ν—ν•  μ λ°–μ— μ—†λ‹¤.

κ·Έλμ„ λ„¤νΈμ›ν¬ λ³΄μ•μ μ¤‘μ”μ„±μ΄ λ€λ‘λλ©° λ°μ΄ν„°λ¥Ό μ „μ†΅ν•λ©΄μ„ μ•”νΈν™”λ¥Ό λ„μ…ν•κ² λμ—λ”λ° μ΄λ• μ‹ν–‰λμ—λ μ‹λ„κ°€ SSL μΈμ¦μ„λ¥Ό μ΄μ©ν• λ°μ΄ν„° μ•”νΈν™” λ° μΈμ¦μ΄λ‹¤. μ΄λ¥Ό ν†µν•΄ λ”μ± μ•μ „ν•κ² λ°μ΄ν„°λ¥Ό λ³΄λ‚΄κ³  λ°›μ„ μ μκ² λμ—λ‹¤. 

μ΄λ¬ν• SSLμ΄ μ μ©λ μ‚¬μ΄νΈμ κ°€μ¥ ν° νΉμ§•μ΄ κ·Έ μ λ…ν• httpsμΈλ°, λ κ±°λ λ“± λ―Όκ°ν• μΌ€μ΄μ¤μ— μ‚¬μ©ν–μ—μ§€λ§ μ§€κΈμ€ μ‚¬μ‹¤μƒ ν‘μ¤€μ΄ λμ–΄ μ „μ—­μ μΌλ΅ λ‹¤ μ‚¬μ©ν•λ‹¤. μ• μ“°λ” κ³³μ΄ μ •λ§ μ—†μ.

> ++ SSL
> μ‚¬μ‹¤ SSLμ€ λ³΄μ• μ†μΌ“ κ³„μΈµμ„ μλ―Έν•  λΏμ΄μ§€λ§ μ„μ μΌλ ¨μ μΈμ¦ λ°©μ‹μ„ μΌμ»«λ” ν”„λ΅ν† μ½ μ΄λ¦„/λ°©λ²•λ΅ μΌλ΅ μ‚¬μ©λλ” κ²½ν–¥μ΄ μλ” λ“―ν•λ‹¤. μ†μκ°€ κ·Έλ¬λ” κ²ƒμ΄ μ•„λ‹ λ€λ‹¤μκ°€ κ·Έλ ‡κΈ° λ•λ¬Έμ— κ·Έλƒ¥ ν•λ‚μ λ°©λ²•λ΅ μΌλ΅ μΌλ°ν™”ν•μ—¬ μ„¤λ…μ„ ν•΄λ³΄κ² λ‹¤.

## TLS
μ΄λ ‡κ² λ³΄λ©΄ μ •λ§ SSLμ„ λ§μ΄ μ“Έ κ²ƒ κ°™μ§€λ§, μ΄μ   SSLμ€ μ™„μ „ν λ„νƒλλ‹¤. 
μ™λƒν•λ©΄ κΈ°μ΅΄ SSLμ—λ” μ—¬λ¬ μ·¨μ•½μ μ΄ μμ—κΈ° λ•λ¬ΈμΈλ°,

1. **μ•”νΈν™” κ°•λ„ λ¶€μ΅±:**
    - SSL 2.0μ€ λ§¤μ° μ•½ν• μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν–μ.
2. **ν•Έλ“μ…°μ΄ν¬ μ·¨μ•½μ :**
    - SSL 2.0μ€ ν•Έλ“μ…°μ΄ν¬ ν”„λ΅ν† μ½μ—μ„ μ¤‘κ°„μ κ³µκ²©(man-in-the-middle attack)μ— μ·¨μ•½ν–λ‹¤. 
	    - μ¤‘κ°„μ κ³µκ²©: 
		    - `μ μ € -> μ„λ²„`κ°€ μ•„λ‹, `μ μ € -> κ³µκ²©μ -> μ„λ²„`μ λ°©μ‹μΌλ΅ κ³µκ²©μκ°€ ν†µμ‹ μ„ μ¤‘κ³„ν•λ” κ²ƒ.
		    - λ‹Ήμ—°ν μ μ €κ°€ μ„λ²„ν•ν… λ­ λ³΄λ‚΄λ”μ§€ μ• μ μκ³  λ°μ΄ν„° λ³€μ΅°λ„ κ°€λ¥ν•¨.
3. **μ„Έμ… μ¬κ° κΈ°λ¥μ λ¬Έμ :**
    - μ„Έμ… μ¬κ°(session resumption) κΈ°λ¥μ€ μ„Έμ… ν‚¤λ¥Ό μ•”νΈν™”ν•μ§€ μ•κ³  μ „μ†΅ν•μ—¬, κ³µκ²©μκ°€ μ΄μ „ μ„Έμ…μ λ°μ΄ν„°λ¥Ό λ³µμ›ν•  μ μλ” κ°€λ¥μ„±μ΄ μμ—μ.

λ“±λ“±... λ” λ§μ€ μ΄μ κ°€ μμ§€λ§ μ”μ •λ„λ΅ ν•΄λ³΄μ. μ•„λ¬΄νΌ SSLμ€ ν•μκ°€ λ§λ λ°©μ‹μ΄μ—λ‹¤!
TLSλ” κΈ°μ΅΄ SSLμ λ°©μ‹μ—μ„ μ·¨μ•½μ λ“¤μ„ λ³΄μ™„ κ°μ„ ν•μ—¬ λ§λ“¤μ–΄μ§„ κ²ƒμΌλ΅, **SSLμ μ—…κ·Έλ μ΄λ“ λ²„μ „μ΄λ‹¤.**

CloudFlare λ“±λ“± κ³³κ³³μ—μ„ **TLSλ΅ λ€μ²΄λμ—λ‹¤λΌλ” ν‘ν„μ„ ν•λ‹¤.** 

λ•λ¬Έμ— μ—„κ²©ν λ”°μ§€λ©΄ μ”μ¦μ—λ” TLSλΌκ³  λ¶€λ¥΄λ”κ² λ§λ”λ°, SSLμ΄λΌλ” μ©μ–΄μ λ³΄νΈμ„± λ•λ¬Έμ— νΌμ©ν•΄μ„ μ“°λ” λ“―ν•λ‹¤.

## SSL / TLS ν”„λ΅ν† μ½
μ΄ ν”„λ΅ν† μ½μ΄ μ–΄λ–»κ² μ΄λ¤„μ§€λ”μ§€ λ€λµμ μΌλ΅λ§ κ·Έλ ¤λ³΄μ.
λ¨Όμ € λ€μΉ­ν‚¤μ™€ λΉ„λ€μΉ­ν‚¤μ— λ€ν• μ§€μ‹μ΄ μμ–΄μ•Όν•λ‹¤.

### λ€μΉ­ ν‚¤
ν•λ‚μ ν‚¤λ΅ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•κ³ , λ λ³µνΈν™”ν•λ‹¤. λ‹Ήμ—°ν, μ΄ ν‚¤κ°€ ν„Έλ¦¬λ©΄ λμ¥μ΄λ‹¤. μ‹¬κ°ν• λ¬Έμ κ°€ λ°μƒν•λ” κ±°λ‹¤.

### λΉ„λ€μΉ­ ν‚¤
![[Pasted image 20240618181057.png]]
κ³µκ° ν‚¤μ™€ κ°μΈ ν‚¤λ΅ μ•”νΈν™” λ° λ³µνΈν™”λ¥Ό μν–‰ν•λ‹¤.
ν•λ‚μ ν‚¤λ΅ μ•”νΈν™” ν–μΌλ©΄ λ‹¤λ¥Έ ν‚¤λ΅λ§ λ³µνΈν™” κ°€λ¥ν•λ‹¤.

μ–΄λ–»κ² μƒνΈμ‘μ©ν•λƒ:
- κ³µκ° ν‚¤λ΅ μ•”νΈν™” ν•λ‹¤λ©΄ -> κ°μΈ ν‚¤λ΅λ§ λ³µνΈν™” κ°€λ¥
- κ°μΈ ν‚¤λ΅ μ•”νΈν™” ν•λ‹¤λ©΄ -> κ³µκ° ν‚¤λ΅λ§ λ³µνΈν™” κ°€λ¥

λ€μΉ­ ν‚¤λ³΄λ‹¤λ” ν™•μ‹¤ν μ•μ „ν•λ‹¤. λ€μ‹ μ— κµ¬ν„λ„ λ³µμ΅ν•κ³  μ†λ„λ„ λλ¦¬λ‹¤.

### SSL / TLSμ—μ„λ”.
λ€μΉ­ ν‚¤μ™€ λΉ„λ€μΉ­ ν‚¤λ¥Ό λ™μ‹μ— μ“΄λ‹¤.

**λ€λµμ μΈ νλ¦„**
![[Pasted image 20240618181156.png]]
- Aκ°€ Bλ΅ μ ‘μ† μ”μ²­μ„ λ³΄λƒμ„ λ•.
- Bκ°€ Aλ΅ μμ‹ μ κ³µκ° ν‚¤λ¥Ό μ¤€λ‹¤.

![[Pasted image 20240618181247.png]]
- Aλ” μμ‹ μ λ€μΉ­ν‚¤λ¥Ό Bμ κ³µκ° ν‚¤λ΅ μ•”νΈν™”ν•λ‹¤.
- κ·Έλ¦¬κ³  μ΄κ±Έ Bν•ν… λ³΄λ‚Έλ‹¤.

![[Pasted image 20240618181316.png]]
- Bλ” μμ‹ μ κ°μΈν‚¤λ΅ Aμ λ€μΉ­ ν‚¤λ¥Ό μ–»μ„ μ μλ‹¤.

![[Pasted image 20240618181335.png]]
- μ΄λ¬λ©΄ A, B λ¨λ‘ λ€μΉ­ ν‚¤λ¥Ό κ³µμ ν•  μ μλ‹¤.
- μ΄μ λ¶€ν„° λ¨λ“  ν†µμ‹ μ— Aμ λ€μΉ­ν‚¤λ΅ μ•”νΈν™”ν•΄μ„ Bν•ν… λ°μ΄ν„°λ¥Ό λ³΄λ‚Έλ‹¤.
- Bμ—μ„λ” Aμ λ€μΉ­ν‚¤λ¥Ό κ°€μ§€κ³  μκΈ° λ•λ¬Έμ— λ°μ΄ν„°λ¥Ό λ³µνΈν™”ν•  μ μλ‹¤.
- Aλ‘ Bλ§ μ• μ μλ” μ†ν†µμ„ ν•  μ μλ‹¤. μ•„μ£Ό κ·Έλƒ¥ μ„Έμƒμ΄ ν•‘ν¬νμ΄μ§€?


### SSL / TLS Handshake
>π’΅**CA?**
>μΈμ¦μ„μ μ—­ν• μ€ ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν• μ„λ²„κ°€ μλ„ν• μ„λ²„κ°€ λ§λ”μ§€ λ³΄μ¥ν•λ” κ²ƒμ΄λ‹¤. μ΄ μ—­ν• μ„ ν•λ” λ―Όκ°„ κΈ°μ—…λ“¤μ΄ μλ”λ° μ΄λ° κΈ°μ—…λ“¤μ„ CA(Certificate authority) νΉμ€ Root CertificateλΌκ³  λ¶€λ¥Έλ‹¤. CAλ” μ‹ λΆ°μ„±μ΄ μ—„κ²©ν•κ² κ³µμΈλ κΈ°μ—…λ“¤λ§ μ°Έμ—¬ν•  μ μλ‹¤.
>
>κ°λ°μ μ…μ¥μ—μ„ HTTPSλ¥Ό μ μ©ν•λ ¤λ©΄ μ‹ λΆ°ν•  μ μλ” CA κΈ°μ—…μ μΈμ¦μ„λ¥Ό κµ¬μ…ν•΄μ•Ό ν•λ‹¤. μ΄ μΈμ¦μ„λ¥Ό κµ¬μ…ν•κ² λλ©΄ CA κΈ°μ—…μ κ°μΈ ν‚¤λ¥Ό μ΄μ©ν•μ—¬ μ•”νΈν™” ν• μΈμ¦μ„λ¥Ό μ¤€λ‹¤.

>π’΅ **SSL μΈμ¦μ„**
>SSL μΈμ¦μ„μ—λ” μ„λΉ„μ¤μ μ •λ³΄ (μΈμ¦μ„λ¥Ό λ°κΈ‰ν• CA, μ„λΉ„μ¤μ λ„λ©”μΈ λ“±)μ™€ μ„λ²„ μΈ΅ κ³µκ° ν‚¤κ°€ λ“¤μ–΄ μλ‹¤.
>
>κ·Έλ¬λ©΄ μ„λ²„μ—μ„λ” λ³ΈμΈμ κ°μΈ ν‚¤λ¥Ό μƒμ„±ν•μ€κ³ , ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ©ν•  κ³µκ° ν‚¤λ” μΈμ¦μ„ μ•μ— λ‹΄κ²¨ μλ”λ°, ν΄λΌμ΄μ–ΈνΈλ” CAμ κ°μΈ ν‚¤λ΅ μ•”νΈν™” λ μΈμ¦μ„λ¥Ό μ–΄λ–»κ² λ³µνΈν™” ν• κΉ?
>
>λ°”λ΅, μ°λ¦¬κ°€ μ‚¬μ©ν•λ” μΌλ°μ μΈ λΈλΌμ°μ €μ— μ‹ λΆ°ν•  μ μλ” CA κΈ°κ΄€μ λ¦¬μ¤νΈμ™€ ν•΄λ‹Ή κΈ°κ΄€μ κ³µκ°ν‚¤λ¥Ό μ΄λ―Έ κ°€μ§€κ³  μλ‹¤. κ·Έλμ„ ν΄λΌμ΄μ–ΈνΈλ” λ‚΄μ¥λ CAμ κ³µκ° ν‚¤λ¥Ό ν™μ©ν•μ—¬ μΈμ¦μ„λ¥Ό λ³µνΈν™”ν•¨μΌλ΅μ¨ μΈμ¦μ„λ¥Ό κ²€μ¦ν• λ’¤, μ„λ²„μ κ³µκ° ν‚¤λ¥Ό κ°€μ Έμ¬ μ μλ‹¤. 

μ΄ κ³Όμ •μ„ CA μΈμ¦μ„λ¥Ό λΌκ³  λλ¦¬λ”κ² ssl / tls ν•Έλ“μ‰μ΄ν¬λ‹¤.
μμ„Έν•κ² μ•μ•„λ³΄μ.

![[Pasted image 20240618173525.png]]
- μ„μ νλ€μƒ‰ ν”„λ΅μ„Έμ¤λ” μ°λ¦¬κ°€ ν”ν λ΄¤λ κ²ƒλ“¤. TCP 3-way handshakeλ‹¤.
- ClientHello -> SeverHello -> Certificate -> ServerHelloDone -> ClientKeyExchange -> ChangeCipherSpec -> Finished -> ChangeCipherSpec -> Finishedλ΅ μƒκ°ν•λ©΄ λλ‹¤.
---
1. **client hello:** μ„λ²„μ— μ—°κ²°μ„ μ‹λ„ν•λ©΄μ„ μ „μ†΅ν•λ” ν¨ν‚·μ΄λ‹¤.
	- μμ‹ μ΄ μ‚¬μ©κ°€λ¥ν• **cipher suit λ©λ΅**, session id, ssl ν”„λ΅ν† μ½ λ²„μ „, **random byte**λ¥Ό λ³΄λ‚Έλ‹¤.
	- cipher suitλ€?![[Pasted image 20240618174309.png]]
		- μ΄κ² μ–΄λ–¤ ν”„λ΅ν† μ½μ΄κ³ , ν‚¤ κµν™ λ°©μ‹μ΄ μ–΄λ–»κ² λκ³ , μΈμ¦μ„ κ²€μ¦μ€ μ–΄λ–»κ² ν•λ©΄, λ€μΉ­ν‚¤ λΈ”λ΅ μ•”νΈν™” λ°©μ‹, λΈ”λ΅ μ•”νΈ μ΄μ©λ°©μ‹, λ©”μ‹μ§€ μΈμ¦ λ°©μ‹λ“¤μ„ κΈ°μ ν• μΌμΆ…μ λ©”νƒ€ λ°μ΄ν„°λΌκ³  μƒκ°ν•λ©΄ λλ‹¤.
	- client helloμ ν¨ν‚· λ¨μ–‘ ![[Pasted image 20240618174544.png]]
---
2. **server hello:** client hello ν¨ν‚·μ—μ„ Cipher suite μ¤‘ ν•λ‚λ¥Ό μ„ νƒν•μ—¬ Clientμ—κ² μ•λ¦¬λ” ν¨ν‚·.
	- μ–΄λ–¤ Cipher suiteλ¥Ό μ“Έμ§€ λ³΄λ‚΄λ©΄μ„ μμ‹ μ SSL λ²„μ „, λ μ„λ²„μ—μ„ λ§λ“  **random byte**λ„ λ³΄λ‚Έλ‹¤.
	- server hello ν¨ν‚·μ λ¨μ–‘ ![[Snipaste_2024-06-18_17-47-43.png]]
---
3. **Certificate:** μ„λ²„κ°€ μκΈ°κ°€ κ°€μ§„ SSL μΈμ¦μ„λ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² λ„κΈ΄λ‹¤.
	- μΈμ¦μ„ μ•μ—λ” μ„λ²„μ κ³µκ° ν‚¤κ°€ λ“¤μ–΄μλ‹¤.
	- μΈμ¦μ„λ” CAμ κ°μΈν‚¤λ΅ μ•”νΈν™” λμ–΄μλ‹¤. CAμ κ°μΈν‚¤λ” λ‚¨λ“¤ν•ν… κ³µκ°κ°€ μ• λμ–΄μμ.
	- ν΄λΌμ΄μ–ΈνΈλ” μ„Έμƒμ— κ³µκ°λμ–΄μλ” CA μ‚¬μ κ³µκ° ν‚¤λ΅ μ΄κ±Έ λ³µνΈν™” μ‹λ„ν•λ‹¤.
	- μΈμ¦μ„κ°€ λ³µνΈν™” λλ‹¤λ©΄ μ λ€λ΅λ κ°μΈ ν‚¤λ΅ μ•”νΈν™”λ κ²ƒμ΄ λ§μΌλ‹, μ‹¤μ  μΈμ¦ λ¬Έμ„κ°€ λ§λ‹¤.
---
4. **Server Hello Done**: λ³µνΈν™”λ μΈμ¦μ„ λ‚΄μ—μ„ μ„λ²„μ κ³µκ° ν‚¤λ¥Ό ν™•λ³΄ν•λ‹¤.
	- μ΄ν›„ μ΄ κ³µκ° ν‚¤λ¥Ό μ΄μ©ν•μ—¬ ν΄λΌμ΄μ–ΈνΈμ 
---
5. **Server Key Exchange**: μ„λ²„μ κ³µκ° ν‚¤κ°€ SSLμ— μ—†λ‹¤λ©΄, κ³µκ° ν‚¤λ¥Ό λ‹¬λΌκ³  μ„λ²„μ— μ”μ²­ν•λ‹¤. κ·Έκ² `Server Key Exchange` μ΄λ‹¤.
---
6. **Client Key Exchange**: λ€μΉ­ ν‚¤λ¥Ό μ„λ²„μ κ³µκ° ν‚¤λ΅ μ•”νΈν™”ν•μ—¬ λ³΄λ‚Έλ‹¤.
	- μ•μΌλ΅ https ν”„λ΅ν† μ½μ„ μ“°λ©° λ³΄λ‚Ό λ°μ΄ν„°λ“¤μ„ μ•”νΈν™”ν•κΈ° μ„ν• λ€μΉ­ ν‚¤λ¥Ό ν΄λΌμ΄μ–ΈνΈκ°€ μƒμ„±ν•λ‹¤.
	- μ΄ λ€μΉ­ ν‚¤λ¥Ό ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ—μ„ μ–»μ€ κ³µκ° ν‚¤λ¥Ό μ΄μ©ν•μ—¬ μ•”νΈν™”!
	- μ΄κ±Έ μ΄μ  μ„λ²„λ΅ λ³΄λ‚Έλ‹¤.
---
7. **ChangeCipherSpec**: ν΄λΌμ΄μ–ΈνΈ, μ„λ²„ λ¨λ‘κ°€ μ„λ΅ν•ν… λ³΄λ‚΄λ” ν¨ν‚·. ν•Έλ“μ‰μ΄ν¬λ¥Ό λλ‚΄κ³  ν†µμ‹ ν•  μ¤€λΉ„κ°€ λμ—λ‹¤λ” μλ―Έλ‹¤.
---
8. **Finished**: SSL Handshakeλ¥Ό μ° μΆ…λ£ν–λ‹¤λ” μλ―Έμ ν¨ν‚·.
---
9. **μ° ν†µμ‹  !** -> μ—¬κΈ°μ„λ¶€ν„° μ§„μ§λ΅ ν•κ³  μ‹¶μ€ ν†µμ‹ μ„ ν•λ‹¤. μ„λΉ„μ¤ μ΄μ©κ³Ό κ΄€λ ¨λ λ¶€λ¶„.


## μ¶”κ°€
- CAμ™€ ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄μ—μ„ μ΄κ² CAκ°€ λ°κΈ‰ν•΄μ¤€ μΈμ¦μ„λΌλ” κ±Έ κ²€μ¦ν•λ” ν”„λ΅μ„Έμ¤κ°€ μμ–΄μ•Όν•λ‹¤.
- x