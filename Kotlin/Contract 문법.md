---
tags:
  - ë¬¸ë²•
---

### Contract ë€?
---
- ë¶ˆí•„ìš”í•œ íƒ€ì… ì²´í¬ í˜¹ì€ ë¶ˆí•„ìš”í•œ ì»´íŒŒì¼ ì—ëŸ¬ë“±ì„ ë°©ì§€í•˜ê³  ì¢€ ë” ìš©ì´í•˜ê²Œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ë¬¸ë²•.

### How to use?
---
```kotlin
@ExperimentalContracts
fun isNotNull(value: Int?): Boolean {
    contract {
        returns(true) implies (value != null)
    }
    return false
}

@ExperimentalContracts
fun main(args: Array<String>) {
    val nullableInt: Int? = 5

    if (isNotNull(nullableInt)) {
        val nonNullInt: Int = nullableInt //ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.    
    }

}
```

Contracts í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ì— ExperimentalContractsë¼ëŠ” ì–´ë…¸í…Œì´ì…˜ì„ ëª…ì‹œí•˜ê³  ë°˜ë“œì‹œ í•¨ìˆ˜ì˜ ì‹œì‘ì— contract ë¸”ë¡ì„ ì„ ì–¸í•´ì¤˜ì•¼ í•œë‹¤.

ê·¸ëŸ°ë°, contractì•ˆì˜ returnì´ ìˆë‹¤ê³  í•´ì„œ ê±°ê¸°ì„œ í•¨ìˆ˜ê°€ ëë‚˜ëŠ”ê²Œ ì•„ë‹ˆë‹¤. 
contract { } ì˜ ë¦¬í„´ ê°’ì´Â **trueë©´ "ì»´íŒŒì¼ëŸ¬ì•¼. ì´ ì¡°ê±´ì€ ì°¸ì´ì•¼. ê¸°ì–µí•´!"**Â ì´ê³ ,
**falseë©´ "ì»´íŒŒì¼ëŸ¬ì•¼. ì´ ì¡°ê±´ì€ ê±°ì§“ì´ì•¼. ì‹ ê²½ì“°ì§€ë§ê³  í• ì¼ ê³„ì† í•´!"**Â ì´ë‹¤.

ê·¸ë ‡ê¸° ë•Œë¬¸ì—, implies () ì˜ ì¡°ê±´ì´ ì–´ë–»ë“  ê°„ì— contract { } ëŠ” ê·¸ëŒ€ë¡œ ë²—ì–´ë‚˜ê³ , ë‹¤ìŒ ì½”ë“œë¥¼ ì´ì–´ì„œ ì§„í–‰í•œë‹¤.

ê·¸ë˜ì„œ ìœ„ ì½”ë“œëŠ” valueì˜ ê°’ì´ nullì´ë“ , nullì´ ì•„ë‹ˆë“  ë¬´ì¡°ê±´ falseë¥¼ ë¦¬í„´í•´ì£¼ê²Œ ë¨.

### ì•„ë‹ˆ,, ê·¸ëŸ¼ ë­” ì†Œìš©ì´ì•¼?
---
```kotlin
@ExperimentalContracts
fun isNotNull(value: Int?): Int {
    contract {
        returns(true) implies (value != null)
    }

	val result: Int = value
	return result
}
```
ì´ë ‡ê²Œ í™œìš©ì´ ê°€ëŠ¥í•˜ë‹¤. ì›ë˜ Int?ì™€ IntëŠ” ë‹¤ë¥¸ ìë£Œí˜•ì´ë‹¤. ê·¸ëŸ¬ë‚˜ ìœ„ì—ì„œ contractì—ì„œ valueê°€ nullì´ ì•„ë‹˜ì„ ì•Œì•˜ìœ¼ë‹ˆ Intì— Int?ì˜ ëŒ€ì…ì´ ê°€ëŠ¥í•œ ê²ƒì´ë‹¤. ì¦‰, ì»´íŒŒì¼ëŸ¬ì—ê²Œ ì˜ëª»ë˜ì§€ ì•Šì•˜ìŒì„ ì•Œë ¤ì¤¬ìœ¼ë‹ˆ ì‹¤ì œë¡œëŠ” ì˜ëª»ëœ ë¬¸ë²•ì´ì—ˆë”ë¼ë„ ë°”ë¡œ ê°€ëŠ¥í•œ ê²ƒì´ë‹¤.

### callsInPlaceë¥¼ í™œìš©í•´ë³´ì.
---
```kotlin
@ExperimentalContracts
fun invokeLambda(lambda: () -> Unit) {
	contract {
		callsInPlace(lambda, InvocationKind.EXACTLY_ONCE)
	}
	lambda()
}
```
ìœ„ì˜ ì½”ë“œì²˜ëŸ¼, implies ëŒ€ì‹  callsInPlaceë¥¼ ì‚¬ìš©í•˜ê¸°ë„ í•œë‹¤.

callsInPlaceëŠ” ëŒë‹¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ë•Œ, ê·¸ í•¨ìˆ˜ì˜ í˜¸ì¶œ íšŸìˆ˜ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì»´íŒŒì¼ëŸ¬ì—ê²Œ ì´í•´ì‹œì¼œì£¼ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë¬¸ë²•ì´ë‹¤.

### callsInPlaceëŠ” ì™œ ì“°ë‚˜ìš”?
---
```kotlin
// callsInPlaceê°€ ì—†ì„ ë•Œ.
val value: String
Contract.invokeLambda {
	value = "TEMP" // Captured values initialization is forbidden due to possible reassignment
}
return value // Variable 'value' must be initialized
```
valë¡œ ì„ ì–¸í•œ ê°’ì´ ì´ˆê¸°í™” ë˜ì–´ìˆì§€ ì•Šì€ ìƒí™©ì´ë‹¤.

- Captured ~ : invokeLambda í•¨ìˆ˜ê°€Â **ëª‡ ë²ˆ í˜¸ì¶œë˜ëŠ”ì§€ ëª…í™•íˆ ëª¨ë¥´ê¸° ë•Œë¬¸ì—, val ë³€ìˆ˜ íŠ¹ì„± ìƒ ì—¬ëŸ¬ ë²ˆ ê°’ì´ ë³€í•  ìˆ˜ ìˆì–´ ì˜¤ë¥˜ ë°œìƒ**

- Variable ~ : ë§ˆì°¬ê°€ì§€ë¡œ, invokeLambda í•¨ìˆ˜ê°€Â **ëª‡ ë²ˆ í˜¸ì¶œë˜ëŠ”ì§€ ëª…í™•íˆ ëª¨ë¥´ê¸° ë•Œë¬¸ì—, return ê°’ì´ ë‹¤ë¥¼ ìˆ˜ ìˆì–´ ì˜¤ë¥˜ ë°œìƒ**

ë§Œì•½ ìœ„ì˜ ì½”ë“œë¥¼ ì‹¤í–‰ ì‹œì¼°ë‹¤ë©´ ìœ„ì™€ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•  ê²ƒì´ë‹¤.
ì™œëƒí•˜ë©´ ì¸ìë¡œ ë“¤ì–´ê°ˆ ëŒë‹¤ê°€ ëª‡ ë²ˆ í˜¸ì¶œë  ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì´ë‹¤.

val ë³€ìˆ˜ì˜ íŠ¹ì„± ìƒ ì¸ìë¡œ ë“¤ì–´ê°€ëŠ” ëŒë‹¤ëŠ” ë‹¨ í•œ ë²ˆë§Œ ì‘ë™í•´ì•¼ í•œë‹¤. ì™œëƒí•˜ë©´ valì˜ ì´ˆê¸°í™”ëŠ” ë‹¨ í•œë²ˆë§Œ ì´ë¤„ì§€ë‹ˆê¹Œ.

ê·¸ëŸ°ë° invokeLambda ì•ˆì—ì„œ ëŒë‹¤ë¥¼ ëª‡ ë²ˆ í˜¸ì¶œí•˜ëŠ”ì§€ ëª…ì‹œë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²ƒì´ë‹¤.

### ì´ìƒí•˜ë„¤
---
> ğŸ˜ : 'ì•„ë‹ˆ,, í•œ ë²ˆë§Œ ì‘ë™í•˜ê²Œ ì¼ì–ì•„,,' 

ê°œë°œì ì…ì¥ì—ì„  ì´ìƒí•  ìˆ˜ ë°–ì— ì—†ë‹¤. ë‹¹ì—°íˆ ã…‡