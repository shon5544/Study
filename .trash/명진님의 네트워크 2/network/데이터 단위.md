### 출처
[Can you explain the concept of streams?](https://stackoverflow.com/questions/507747/can-you-explain-the-concept-of-streams) (스트림이란)
___
### 개요
* [[#네트워크에서 데이터 단위 정리하기]]
* [[#스트림과 버퍼]]
* [[#유저 영역에서의 데이터 정리]]
* [[#커널 영역의 데이터 단위 (패킷, 세그먼트)]]
* [[#패킷]]
* [[#Packet VS Circuit]]
* [[#세그먼트]]
___
### 네트워크에서 데이터 단위 정리하기

![[Pasted image 20231222132856.png]]

==**유저 영역에서 다루는 데이터의 크기는 스트림이고 스트림이란 연속된 데이터의 흐름을 말한다. ==유저 영역에서 다루는 데이터가 스트림인 이유는 소켓을 거치기 때문이다. 소켓은 송.수신된 바이트들이 지나가는 일종의 파일**인데 이는 파일 스트림의 형태로 조회 되므로 소켓을 통해 데이터를 전달 받는 유저 영역의 데이터는 “스트림”의 형태를 띈다. **TCP 계층에서 세그먼트 단위로 분할된 데이터들이 다시 연결 조합되면서 스트림(연속된 흐름)을 생성해 소켓으로 전달해준다.**
___
### 스트림과 버퍼

![[Pasted image 20231222133021.png]]
- **스트림이 뭔데?**  
    **스트림은 개울이란 뜻으로 연속적으로 흐르는 데이터**를 말한다.    
    대표적인 스트리밍 서비스인 유튜브를 생각해보자 우리는 동영상을 연속적으로 시청할 수 있다. 동영상은 재생되면 동영상의 끝까지 자동적으로 로딩 및 재생이 실시된다. 만약 **유튜브가 스트림을 사용하지 않는다면 몇초 단위로 동영상 다운 받기 버튼을 눌러야 동영상이 다운 받아질 것이고 모든 다운로드를 끝내야 재생이 가능할 것이다.**
    
    파일 스트림, 문자열 스트림 같은 용어도 전부 동일한 의미이다. 연속적으로 파일의 데이터를 읽거나 쓸 수있다면 파일에 관한 데이터 흐름이 만들어지고 이것이 곧 파일 스트림이 되는 것이다.

* **버퍼는 뭔데?**
	스트림 이야기를 하면 빼놓지 않고 등장하는 개념이 버퍼이다. 버퍼란 임시 저장소로 프로그램이 데이터를 읽거나 전송하기 전에 데이터를 임시로 보관하는 공간을 말한다. **버퍼를 사용하는 이유는 다양하지만 가장 큰 이유는 데이터 소실 방지이다.**
	
    데이터 송신이 진행된다고 할때 데이터 수신자 측이 한번에 처리할 수 있는 데이터의 양이 1인데 송신자가 데이터를 10씩 전송한다 해보자. 이 경우 처리량을 초과하는 데이터는 그냥 버려지게 된다. 이는 다시금 재전송을 실시 하는 비효율을 발생하므로 초과 값은 버퍼에 저장해 놓고 처리를 끝내면 버퍼에서 연속해서 꺼내 사용하는 방식을 활용한다. 

* **버퍼링은 뭔데?**
	<u><b>버퍼링은 버퍼를 채우는 행위를 말한다. 버퍼에 있는 데이터는 이미 수신된 데이터이므로 연속해서 재생이 가능하지만, 버퍼에 없는 데이터는 서버로 부터 수신해야 하기 때문에 로딩에 시간이 소요된다. </b></u>이에 따라 미리 버퍼에 데이터를 일정수준 적재하고 이를 연속적으로 꺼내오는 방식으로 동영상 스트리밍 서비스를 구현하는데, 버퍼에 데이터가 찰때까지 대기하는 이 행위를 버퍼링이라 부른다.

___
### 유저 영역에서의 데이터 정리

유저 영역에 집중해보자. ==**프로세스 영역에서 사용하는 데이터는 소켓을 통해 연속적으로 들어온다.**== 소켓은 하나의 파일로 네트워크를 통해 들어오는 데이터는 모두 소켓을 통과한다. 정리하면 TCP를 통해 세그먼트 단위로 쪼개진 데이터가 소켓을 지나면서 연속적으로 입력되게 되고 이것이 곧 데이터 스트림이 된다.
___
### 커널 영역의 데이터 단위 (패킷, 세그먼트)

![[Pasted image 20231222133637.png]]

커널 영역에서 다루는 데이터 단위는 크게 세그먼트와 패킷이 존재한다. <span class="red red-bg">세그먼트와 패킷은 데이터의 분할 단위로 데이터를 손실 없이 전송하기 위해 데이터를 쪼갠 단위를 나타낸다.</span>

- **스트림은 연속적이라는 데이터라면서 왜 쪼개나요?**
    이런 의문이 생겼다면 흐름을 아주 잘 캐치하고 있는 중이라고 할 수 있다. **스트림이 연속적인 데이터이고 물줄기라면 쪼개지면 안되지 않나? 세그먼트나 패킷 단위로 분할하면 연속성을 잃는 것 아닌가?**
    
    이에 대한 답변은 데이터를 전달하는 방식이 물줄기에서 박스 포장된 컨베이어 벨트로 변환된 것이라 이해할 수 있다. 기존에는 데이터가 구분 없이 연속적으로 전달됐다면 이제 개별 포장돼 연속적으로 전달되는 형태를 갖는다.
    
    여기서 중요하게 생각해야할 부분은 어찌됐든 데이터를 연속적으로 전달한다는 것이다. 스트림의 방점은 데이터를 전달하는 방식에 집중 돼있다. 연속적으로 전달한다면 스트림이라 할 수 있다. **즉, 데이터가 분할돼도 연속적으로만 입,출력이 발생하면 스트림이라는 것이다.**

* **왜 쪼개서 전송을 하나요?**
	데이터를 그냥 전송하면 안될까? 왜 쪼개서 전송을 하는 것일까. 엄청나게 큰 파일을 전송해야 한다고 생각해보자. 큰 파일을 전송 한다면 한개의 오류만 검출 돼도 파일을 전부 처음부터 다시 전송해야 하는 문제가 발생한다. 하지만 데이터를 쪼개서 전송할시 문제가 생긴 쪼개진 부분만 다시 전송하면 되기 때문에 이러한 비효율을 해결할 수 있다. 추가적으로 큰 파일을 한번에 전송하려면 서버에 엄청난 부하를 주게 된다.

___
## 패킷

![[Pasted image 20231110233821 1.png]]

<b><u>네트워크에서 정보를 주고 받을 때 데이터를 분할해 주고 받곤 하는데 이 분할 단위를 패킷이라 부른다.</u></b> 패킷이 한번에 묶어서 보낼 분할된 데이터의 양을 의미하기 때문에 package + bucket의 합성어인 패킷이 됐다. (상자 안의 데이터 바구니) 패킷은 헤더와 페이로드로 구분되는데 헤더에는 프로토콜, 목적지 ip, 출발지 ip 등이 존재하고 페이로드에는 실제 데이터가 저장돼 있다. **3계층 이하에서의 데이터 단위를 패킷이라 부르며 패킷 스위칭 같은 키워드도 여기서 유래됐다.**
___
### Packet VS Circuit

데이터를 전송하는 방식은 크게 Circuit Switching과 Packet Switching로 구분 가능하다. 

* **Circuit Switch**
	**하나의 회선을 예약해서 데이터를 주고 받는 방식으로 출발지 부터 목적지까지의 채널 전체를 독점하기 때문에 다른 사람이 끼어들 수 없다.** 해당 방식은 이전의 전화 통신 등에 사용됐다. (예전에 전화국에서 바꿔주던 시절을 생각하면 된다.) 
	이러한 방식은 회선을 계속해서 사용 가능하기 때문에 딜레이가 적고 장시간 전송에 유리하다. 하지만 회선에 독점이 발생한다는 문제가 발생한다.

* **Packet Switching**
	**하나의 데이터를 여러 개의 패킷으로 분리하여 그때 그때 사용 가능한 채널로 전송하는 방식**이다. 회선을 예약하는 방식이 아니기 때문에 대역폭에 낭비 없이 채널을 알차게 활용할 수 있다. 또한 독점이 없기 때문에 여러명의 유저가 동시에 사용하는 것도 가능하다.
	 
	**하지만 경로를 그때 그때 설정해야 한다는 점에서 딜레이가 발생하고 라우터 등의 메모리가 가득차면 유실의 가능성도 존재한다.**

**네트워크를 항상 사용하고 있는 상황이 아닌 이상 한명이 채널을 독점하고 사용하는 것은 리소스 낭비가 심한 방법**이다. 이에 따라 **리소스를 최대한 활용할 수 있는 패킷 스위칭 방식을 대부분 사용**하고 있다.
___
### 세그먼트

![[Pasted image 20231222140805.png]]

**세그먼트는 TCP/UDP 프로토콜에서 사용하는 데이터 단위로 소켓으로부터 송,수신된 데이터 스트림을 일정 단위로 분할한 데이터 조각**을 말한다. 세그먼트는 실제 데이터와 헤더로 구분되며 이때 사용하는 헤더를 TCP/UDP 헤더라 부른다. 헤더와 세그먼트를 조합하면 세그먼트가 되며 전송 계층에서는 해당 데이터 단위를 송,수신한다
